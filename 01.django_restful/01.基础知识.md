# DRF 框架

## 1. 基础知识

- 1 域名

  前后端域名可以不一致

- 2 版本

  ```python
  =一种方法，版本直接放在url中
  https://www.badiu.com/1.0/api/
  https://www.badiu.com/1.1/api/
  =一种方法，版本放在HTTP头中
  Accept:vnd.example-com.foo+json;version=1.0
  Accept:vnd.example-com.foo+json;version=1.1
  ```

  

- 3 路径

  ```python
  1. 资源作为网址，只能有名词，不能有动词，而且所用名词与数据库表明对应（实际开发中，最好换一下，保护数据库安全）
  错误实例：
  	/getProducts
      /listOrdeers
   对于一个简洁结构，你应该始终用名词，此外，利用的HTTP方法可以分离网址中的资源名称的操作。
  GET /products 将返回所有产品清单
  POSt /products 新建产品到集合
  GET /products/4 获取产品4
  PATCh或者PUT /products/4 更新产品4
  
  2. API中的名词应该使用复数，无论子资源或者所有资源
   获取单个产品:https://127.0.0.1:8000/AppName/rest/products/1
  获取所有商品：https://127.0.0.1:8000/AppName/rest/products
  
  ```

- 4 HTTP动词

  常用的HTTP动词有下面四个(括号中代表SQL命令)

  ```shell 
  GET (SELECT):从服务器中取出资源
  POST (CREATE)：在服务器新建一个资源
  PUT(UPDATE):在服务器更新资源（客户端提供改变后的完整资源）
  DELETE(DELETE):从服务器删除资源。
  ```

  不常用的三个

  ```shell
  PATCH(UPDATE):在服务器更新资源
  HEAD:获取资源的元数据
  OPTIONS:获取信息，关于资源的哪些属性是客户端可以改变的
  ```

  例如：

  ```python
  GET /zoos:列出所有的动物园
  POST /zoos:新建一个动物园
  GET /zoos/ID:获取某个指定动物园的信息
  PUT /zoos/ID:更新摸一个指定动物园的信息（提供动物园全部信息）
  PATCH /zoos/ID:更新某个指定动物园信息（提供动物园部分信息）
  DELETE /zoos/ID:删除某个动物园
  GET /zoos/ID/animals:列出某个指定动物园的所有动物
  DELETE /zoos/ID/animals/ID:删除动物园的某个动物   
  ```

- 5 过滤信息

  如果记录数量很多，服务器不可能将他们返回完，API应该提供参数，过滤返回结果。

  例如

  ```python
  ?limit=10:指定返回记录数量
  ?offset=10:指定返回记录的开始位置
  ?page=2&per_page=100:指定第几页，以及每页的记录数
  ?sortby=name&order=asc:指定返回结果按照那个属性排序，以及排序顺序
  ?animal_type_id=1:指定筛选条件
  ```

  参数的设计允许存在冗余，既允许API路径和URL参数偶尔有重复，比如，GET /zoos/ID/animals 与GET /animals?zoo_id=ID 都是列出动物园的所有动物。

- 6 状态码

  200 OK

  404 NOT FOUND

  等等

- 7 错误处理

  如果状态码是xxx 返回一定的错误，error为键，错误信息为值。

  ```json
  {
  	"error":"Invalid API key"
  }
  ```

- 8 返回结果

  GET /collection :返回资源对象的列表

  GET /collection/resource: 返回单个资源对象

  POST /collection/:返回新生成的资源对象

  DELETE:返回一个空文档

- 9 超媒体

  如果有多个数据，我们可以不给数据，可以把多个数据的获取接口放回去。

  